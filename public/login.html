<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login ‚Ä¢ Movidesk</title>
  <link href="style.css" rel="stylesheet" />
  <style>
    :root {
      --bg: #0b1220;
      --panel: rgba(17,24,39,0.55);
      --panel-border: rgba(148,163,184,0.25);
      --text: #e5e7eb;
      --text-muted: #94a3b8;
      --input-bg: rgba(2,6,23,0.85);
      --input-border: rgba(148,163,184,0.25);
      --input-focus: #60a5fa;
      --btn: #2563eb;
      --btn-hover: #1d4ed8;
      --card-shadow: 0 20px 40px rgba(0,0,0,0.35);
      --card-glass: blur(8px);
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f5f7fb;
        --panel: rgba(255,255,255,0.9);
        --panel-border: rgba(0,0,0,0.06);
        --text: #0f172a;
        --text-muted: #475569;
        --input-bg: #ffffff;
        --input-border: rgba(15,23,42,0.12);
        --input-focus: #1d4ed8;
        --btn: #2563eb;
        --btn-hover: #1d4ed8;
        --card-shadow: 0 14px 28px rgba(2,6,23,0.12);
        --card-glass: blur(6px);
      }
    }

    body.loginPage {
      min-height: 100vh;
      display:flex; align-items:center; justify-content:center;
      padding: 24px; background: var(--bg);
    }
    .loginWrap { width: 100%; max-width: 640px; }
    .loginCard {
      position: relative;
      border-radius: 22px;
      padding: 28px 28px 24px;
      background: var(--panel);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 40px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,0.08);
      border: 1px solid rgba(148,163,184,0.20);
    }
    .loginCard::before {
      content: "";
      position: absolute; inset: 8px; border-radius: 16px;
      border: 1px solid rgba(148,163,184,0.20); pointer-events: none;
    }
    .loginLogo { display:flex; align-items:center; justify-content:center; margin-bottom: 18px; }
    .loginCard label {
      display:block; font-weight:700; margin: 10px 0 8px;
      color: var(--text); letter-spacing:.2px;
    }
    .loginInner { max-width: 540px; margin: 0 auto; }
    .fields { display:flex; flex-direction:column; gap:16px; }
    .bubble { width:100%; padding:14px 16px; border-radius:16px; outline:none; background: rgba(203,213,225,0.15); border:1px solid rgba(148,163,184,0.25); color: var(--text); transition: border-color .15s, box-shadow .15s, background .15s, transform .06s; }
    .bubble:hover { transform: translateY(-1px); }
    .bubble:focus { border-color: #60a5fa; box-shadow: 0 0 0 4px rgba(96,165,250,.22), 0 6px 18px rgba(37,99,235,.20) inset; background: rgba(203,213,225,0.20); }
    .bubble-row{ display:flex; align-items:center; padding:0; }
    .bubble-row input{ all:unset; flex:1; padding:14px 12px; color:inherit; }
    .bubble-row .eyeBtn{ all:unset; cursor:pointer; padding:8px 12px; color:#a8b3c7; }
    .loginActions { display:flex; align-items:center; justify-content:space-between; gap:16px; margin-top: 18px; }
    .btnPrimary { padding:12px 22px; border:none; border-radius:14px; color:#fff; font-weight:800; letter-spacing:.2px; cursor:pointer; background: linear-gradient(180deg, #2563eb, #496cdf); box-shadow: 0 10px 26px rgba(37,99,235,.35); transition: transform .05s, filter .15s, box-shadow .2s; }
    .btnPrimary:hover { filter: brightness(1.05); }
    .btnPrimary:active { transform: translateY(1px); }
    .btnPrimary.loading { opacity:.8; cursor:wait; box-shadow:none; }
    .muted { color: #a8b3c7; font-size: 13px; }
    .appFooter { text-align:center; margin-top:18px; color: #a8b3c7; font-size:12px; }
  </style>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('loginForm');
      if (!form) return;
      const btn = form.querySelector('.btnPrimary');
      const eyeBtn = form.querySelector('.eyeBtn');
      const pwd = document.getElementById('password');
      if (eyeBtn && pwd) {
        eyeBtn.addEventListener('click', () => {
          const vis = pwd.getAttribute('type') === 'text';
          pwd.setAttribute('type', vis ? 'password' : 'text');
          eyeBtn.textContent = vis ? 'üëÅ' : 'üëÅ';
        });
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        btn.disabled = true; btn.classList.add('loading');
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;
        if (!username || !password) { alert('Informe usu√°rio e senha'); btn.disabled=false; btn.classList.remove('loading'); return; }

        try {
          const res = await fetch('/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password })
          });
          const data = await res.json().catch(() => ({}));
          if (res.ok && data && data.success) {
            if (data.mustChangePassword) { window.location.href = '/password'; return; }
            window.location.href = '/dashboard';
            return;
          }
          alert((data && data.error) || 'Falha no login');
        } catch (err) {
          console.error('Falha no login:', err);
          alert('Erro de conex√£o com o servidor');
        } finally {
          btn.classList.remove('loading'); btn.disabled = false;
        }
      });
    });
  </script>
</head>
<body class="loginPage">
  <div class="loginWrap">
    <form id="loginForm" class="loginCard" autocomplete="on" onsubmit="return false">
      <div class="loginLogo">
        <img class="logoGradient" src="/logo-viasoft.png" alt="Viasoft" height="42" />
      </div>

      <div class="fields">
        <div>
          <label for="username">Usu√°rio</label>
          <input id="username" class="bubble" name="username" required autofocus />
        </div>
        <div>
          <label for="password">Senha</label>
          <div class="bubble bubble-row"><input id="password" name="password" type="password" required /><button type="button" class="eyeBtn" aria-label="Mostrar senha" title="Mostrar/ocultar senha">üëÅ</button></div>
        </div>
      </div>

      <div class="loginActions">
        <button class="btn btnPrimary" type="submit">Entrar</button>
        <span class="muted">Dica: pe√ßa ao admin para criar seu acesso.</span>
      </div>
    </form>
    <div class="appFooter">Desenvolvido para Viasoft ¬© 2025</div>
  </div>
</body>
</html>


