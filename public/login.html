<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Login â€¢ Movidesk - Sistemas Internos</title>
  <link href="style.css" rel="stylesheet" />
</head>
<body>
  <div class="loginWrap">
<form class="loginCard" method="POST" action="/login" autocomplete="on">
  <div class="loginLogo">
    <img src="/logo-viasoft.png" alt="Viasoft">
  </div>

  <label for="username">UsuÃ¡rio</label>
  <input id="username" name="username" required autofocus />

  <label for="password">Senha</label>
  <input id="password" name="password" type="password" required />

  <div class="loginActions">
    <button class="btn btnPrimary" type="submit">Entrar</button>
    <span class="muted">Dica: peÃ§a ao admin para criar seu acesso.</span>
  </div>
</form>
  </div>
  <div class="appFooter">Desenvolvido para Viasoft Â© 2025</div>
<script>
  const form = document.querySelector(".loginCard");
  const btn = form.querySelector(".btnPrimary");

  form.addEventListener("submit", async function (e) {
    e.preventDefault(); // impede envio tradicional
    btn.classList.add("loading");

    const formData = new FormData(form);
    const payload = {
      username: formData.get("username"),
      password: formData.get("password"),
    };

    try {
      const res = await fetch("/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      const data = await res.json();

      if (data.success) {
        // ðŸ”¹ redireciona para a dashboard
        window.location.href = "/dashboard";
      } else {
        alert(data.error || "Falha no login");
        btn.classList.remove("loading");
      }
    } catch (err) {
      alert("Erro de conexÃ£o com o servidor");
      btn.classList.remove("loading");
    }
  });
</script>


</body>
</html>
